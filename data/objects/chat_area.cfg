{
	id: "chat_area",

	always_active: true,
	hidden_in_game: true,
	is_strict: true,

	on_create: "
	set_widgets([{
		type: 'text_editor',
		id: 'chat',
		width: 340,
		height: 300,
		text: '',
		font_size: 16,
	},

	{
		type: 'text_editor',
		id: 'entry',
		width: 340,
		y: 306,
		font_size: 16,
		on_enter: q(fire_event('enter')),
	}])
	",

	on_enter: "[
		if(controller, controller.send_chat(_entry_widget.text)),
		set(_entry_widget.text, ''),
	]",

	properties: {
		has_focus: "bool :: _entry_widget.has_focus",
		_entry_widget: "text_editor_widget<- widgets.entry",
		_chat_widget: "text_editor_widget<- widgets.chat",
		controller: "find(level.chars, value is obj citadel_controller)",

		message_received: "def(string nick, string text) ->commands [
			add(_chat_widget.text, '\n <' + nick + '> ' + text),
		]",
	},
}
