{
	"animation": [
		{
			"id": "main",
			"image": "tiles.png",
			"rect": [71,1,102,21],
			frames: 20,
			frames_per_row: 5,
			duration: 1,
		},
		{
			"id": "village",
			"image": "tiles.png",
			"rect": [25,106,56,126],
			frames: 5,
			frames_per_row: 5,
			duration: 1,
		},
		{
			"id": "forest",
			"image": "tiles.png",
			"rect": [25,74,56,105],
		}
	],
	"id": "tile",

	vars: {
		controller: null,
		is_selectable: false,
		loc: [0,0],
		mouseover: false,
	},

	properties: {
		selectable: { get: "vars.is_selectable", set: "set(vars.is_selectable, value)" },
	},

	on_spawned: "[set(vars.controller, spawner), set(time_in_animation_delta, 0)]",
	on_enter_anim: "add(y, -(img_h - 20)/2 )",
	on_create: "
	[add(zorder, vars.loc[0]),
	if(vars.game.villages[vars.loc] != null,
	  [
	  spawn('tile.level_label', mid_x - 14, mid_y - 8, 1, [set(child.time_in_animation, vars.game.villages[vars.loc].level + (vars.game.villages[vars.loc].owner + 1)*3)]),

	  if(vars.game.villages[vars.loc].owner = -1,
	     [set(time_in_animation, 13)],
	     [set(animation, 'village'),
		  set(time_in_animation, vars.game.villages[vars.loc].type-1),
		  set(time_in_animation_delta, 0)])],
		 //if not a village
		 if(terrain, set(animation, terrain.type))
		   where terrain = vars.game.terrain[vars.loc]
		  )]",

	on_click: "vars.controller.tile_clicked(me)",

	on_mouse_enter: "set(vars.mouseover, true)",
	on_mouse_leave: "set(vars.mouseover, false)",

	on_process: "if(vars.mouseover, set(brightness, 500),
	                if(selectable, set(brightness, 255 + wave(cycle*12)/10),
							       set(brightness, 255)))",
	
	object_type: [
		{
			id: "level_label",
			animation: [
				{
					id: "normal",
					image: "citadel-buildings.png",
					rect: [117,3,126,12],
					duration: 1,
					frames_per_row: 3,
					frames: 9,
					pad: 0,
				}
			],

			zorder: 500,
			on_spawned: "[set(time_in_animation_delta, 0)]",
		}
	]
}
