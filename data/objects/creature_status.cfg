{
	id: "creature_status",

	hidden_in_game: true,

	animation: [
	{
		id: "normal",
		image: "effects/particles.png",
		x: 86,
		y: 73,
		w: 28,
		h: 28,
		collide: [0,0,28,28],
		frames: 1,
		duration: 1000,
	}
	],

	vars: {
		creature_object: null,
		controller: null
	},

	on_spawned: "set(vars.controller, spawner)",

	properties: {
		creature_object: {
		  set: "execute(me, [
		    spawn('creature', me.mid_x + 50, me.mid_y, 1, [set(child.zorder, zorder+5), set(child.image_num, value.image_num)]),
			set_widgets([
			  {
			  	type: 'grid',
				padding: [10,10],
				columns: 3,
				x: 40,
				y: 60,
				children: fold(map(abilities,
				 [
				  {
					type: 'label',
					color: 'white',
					text: str(value.cost),
					size: 12
				  },
				  {
					type: 'button',
					resolution: 'double',
					padding: [20, 20],
					label: {type: 'graphical_font_label', text: value.name, font: 'default', size: 1},
					on_click: 'vars.controller.ability_clicked(vars.creature_object, q(' + value.name + '))'
				  },
				  {
					type: 'label',
					color: 'white',
					text: value.rules,
					size: 12
				  }
				 ]),
				 a + b
				)
			  }
			]) where abilities = [a | a <- value.abilities, not is_string(a)],
		    set(vars.creature_object, value),
		  ])",
		  get: "vars.creature_object"
		},
	},
}
