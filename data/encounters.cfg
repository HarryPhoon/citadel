//List of possible encounters the player can face. Each entry here fills
//in fields from classes/campaign_encounter.cfg
[

{
	title: "The Guardian Bandits",
	image: "portraits/guardianking.png",

	text: "Wandering through the forest, you notice the tracks of the Guardians rumored to be harassing the townspeople. You could follow their tracks or leave them be.",

	options: [ 'Track', 'Leave' ],

	choose_option: "def(obj title_controller ctrl, string option) ->commands
	if(option = 'Track', [

		  //show some dialog preparing the player to fight.
		  set(text, 'Tracking the guardians to their lair you must fight them!'),
		  set(options, ['Battle']),
	   ],

	   option = 'Battle', [
	   	  //Go into the battle by setting the scenario the player will face.
	   	  set(scenario, {
			name: 'Izlik',
			set: 'core',
			enemy_name: 'Izlik',
			text: '',
			bot_args: {
				deck: q(['Green Adder', 'Direwolf', 'Darkwood Denizen']*4),
			},
			portrait: 'grizzis-lord-of-the-hunt.png',
			portrait_scale: 0.2,
			portrait_translate: [0,0],
			avatar: 'grizzis-lord-of-the-hunt.png',
		  }),
	   ],

	   option = 'Leave', [
	      //Give the player some 'goodbye' dialog before closing out the
		  //encounter.
	   	  set(text, 'You leave the guardians be today, perhaps one day they will become your allies.'),
		  set(options, ['Finish']),
	   ],

	   option = 'Finish', [
	   	  //this will completely close down the encounter.
	   	  set(finished, true),
	   ],
	)
	",

	win_battle: "def(obj title_controller ctrl) ->commands
	[
	  set(text, 'You have defeated the guardians and sack their lair. No longer will travelers have to slink through the forest in fear.'),
	  set(options, ['Finish']),
	]",

	lose_battle: "def(obj title_controller ctrl) ->commands
	[
	  set(text, q(Defeated by the guardians you slink back to the town, living to fight another day.)),
	  set(options, ['Finish']),
	]
	",
},

{
	title: "Dark Druid Call to Adventure",
	image: "portraits/forest.png",

	image_focus_x: 400.0,
	image_focus_y: 700.0,
	image_zoom: 1.0,

	next_image_focus_x: 400.0,
	next_image_focus_y: 100.0,
	next_image_zoom: 1.0,

	image_animate_time: 1200,

	quest_id: "dark_druid",
	min_quest_progress: 0,
	max_quest_progress: 5,

	text: "While traveling through the forest you come upon a disturbing find: a freshly dismembered goat's head upon a crude stone altar. You may continue on the path you were on, or turn back and seek a different path.",

	options: [ 'Continue', 'Turn Back' ],
	choose_option: "def(obj title_controller ctrl, string option) ->commands
	if(option = 'Continue', [
		set(text, q(You continue along with some degree of trepidation. Coming upon a clearing you find a group of acolytes, attired in black, five forest guardians lay freshly slaughtered. Their leader turns to greet you.

<i>It is good you have come here, the Gods of Death have decreed that the time for this foul, twisted forest is at an end, and all in it should pass on. However, the Forest Guardians fight desperately to continue the suffering that life is. It is your place, traveler, to help us in defeating the evil Guardians in their futile efforts.</i>

Considering these words, you must either agree to fight the Guardians or refuse.)),
		set(options, ['Accept', 'Refuse']),

		set(image, 'portraits/soothsayer.png'),
		set(image_focus_x, 400.0),
		set(image_focus_y, 100.0),
		set(image_zoom, 1.6),
		set(image_animate_easing, lib.math.ease_out_cubic),
		set(next_image_focus_x, 400.0),
		set(next_image_focus_y, 400.0),
		set(next_image_zoom, 1.0),
		set(image_animate_time, 1200),

		set(image_transition, enum fade),
		set(image_transition_time, 300),

	],

	option = 'Accept', [
		set(text, q(Having accepted the wish of the Gods of Death to put an end to life in the dark forest, one of the black acolytes leads you down a trail to meet a party of the Guardians who seek to destroy the altars. <i>We will support you with one of our holy Altars</i> the acolyte promises you as you prepare for battle.)),
		set(tag, 'attack_guardians'),
		set(options, ['Battle']),

		set(image, 'portraits/intense-warfare.png'),
		set(image_focus_x, 400.0),
		set(image_focus_y, 400.0),
		set(image_zoom, 2.5),
		set(next_image_zoom, 1.0),
		set(image_animate_time, 1200),

		set(image_transition, enum fade),
		set(image_transition_time, 300),

		//note that we will get help in the fight.
		set(vars['have_help'], true),
	],

	option = 'Refuse', [
		set(text, q(<i>You refuse to cede to the wishes of the Gods of Death?</i> the black priest asks. <i>The only use life has in this realm is if it is working to end life. The taint is on you too, and now your own life will end.</i>)),
		set(tag, 'attack_acolytes'),
		set(options, ['Battle']),

		set(image_animate_time, 300),
		set(image_zoom, 2.5),
		set(image_focus_x, 400.0),
		set(image_focus_y, 400.0),
	],
	
	option = 'Turn Back', [
		set(text, q(Turning back from the ominous goat's head, you walk through the forest, having the ominous feeling that you are being watched. Looking this way and that, you continue on. When you reach a clearing you find yourself confronted by a half dozen forest Guardians. They explain that the forest has been plagued by strange, malevolent forces over the last year, and a dark taint rests over a portion of the forest. They implore you to help them in fighting back against these malevolent forces. Do you assist these guardians of the forest?)),
		set(options, ['Help', 'Decline']),

		set(image, 'portraits/guardian-sapper.png'),
		set(image_focus_x, 300.0),
		set(image_focus_y, 400.0),
		set(image_zoom, 2.5),
		set(next_image_zoom, 1.0),
		set(image_animate_time, 1200),
		set(image_animate_easing, lib.math.ease_out_cubic),

		set(image_transition, enum fade),
		set(image_transition_time, 200),
	],

	option = 'Help', [
		set(text, q(Agreeing to fight the taint that threatens the forest, the Guardians lead you to a clearing where you see a stone circle with Dark Acolytes performing a strange ritual on the corpses of Guardians. With a promise of support from the Guardians, you fall upon them.)),
		set(tag, 'attack_acolytes'),
		set(options, ['Battle']),

		set(image, 'portraits/bloodaltar.png'),
		set(image_focus_x, 400.0),
		set(image_focus_y, 400.0),
		set(image_zoom, 2.5),
		set(next_image_zoom, 1.0),
		set(image_animate_time, 1200),
		set(image_animate_easing, lib.math.ease_out_cubic),

		set(image_transition, enum fade),
		set(image_transition_time, 400),

		//note that we will get help in the fight.
		set(vars['have_help'], true),
	],
	
	option = 'Decline', [
		set(text, q(The Guardians seem sorry to not have you on their side in fighting the darkness that threatens the forest, but they let you go on your way unhindered. Clearly you have more important battles to fight.)),
		set(options, ['Leave']),

		set(image, 'portraits/forest.png'),
		set(image_focus_x, 400.0),
		set(image_focus_y, 400.0),
		set(image_zoom, 2.5),
		set(next_image_zoom, 1.0),
		set(image_animate_time, 1200),
		set(image_animate_easing, lib.math.ease_out_cubic),

		set(image_transition, enum fade),
		set(image_transition_time, 200),
	],
	
	option = 'Leave', [
		set(finished, true),
	],
	
	option = 'Battle', [
		set(scenario, Scenario<- (lib.maps.get_map('TinyHex') + {
			enemy_name: if(tag = 'attack_acolytes', 'Tasar', 'Izlik'),
			set: 'core',
			text: '',
			bot_args: {
				deck: if(tag = 'attack_acolytes',
				         q(['Soothsayer', 'Vampire', 'Hypothermia', 'Skeletal Parasite']*4),
				         q(['Darkwood Denizen', 'Direwolf', 'Guardian Tracker', 'Green Adder', 'Forest', 'Monstrous Growth']*4),
					  )
			},

			starting_units: [
				//Two villages in the center row.
				{ card_name: 'Village', loc: [1,1] },
				{ card_name: 'Village', loc: [1,2] },
			] +
			if(vars['have_help'] and tag = 'attack_acolytes', [
				{ card_name: 'Hunting Grounds', loc: [1,0] },
			],
			vars['have_help'],
			[
				{ card_name: 'Blood Altar', loc: [1,0] },
			],
			[]),

			avatar: if(tag = 'attack_acolytes', 'soothsayer.png', 'guardian-king.png'),
		})),
	])
	",

	win_battle: "def(obj title_controller ctrl) ->commands
	[
	  ctrl.add_campaign_quest('dark-forest'),
	  ctrl.progress_campaign_quest('dark-forest', 20),
	  if(tag = 'attack_acolytes',
		set(text, q(You defeat the dark Acolytes, sending the last of their number running away into the forest. With the help of the Guardians you destroy their altars. <i>These dark ones continue to plague and pester us. We hope you will help drive them from the forest completely</i> the lord of the Guardians implores. Perhaps one day you will be able to do so.)),
		set(text, q(The Guardians are vanquished, the last of their number sent scurrying away in retreat. The leader of the Acolytes shakes his head slowly and remorsefully. <i>The only thing sadder than seeing life end is seeing it continue.</i> He says, <i>This forest is a dark and twisted place, hopefully you can help us find the Guardian Lord and end him once and for all, then we can put this twisted forest to an end.</i>))
	  ),

	  set(options, ['Leave']),
	]
	",

	lose_battle: "def(obj title_controller ctrl) ->commands
	[
	  if(tag = 'attack_acolytes',
		set(text, q(The Acolytes have defeated you, and only with the help of the forest Guardians do you yourself escape with your life. Perhaps one day you will be able to return and exact your revenge.)),
		set(text, q(The Guardians have defeated you. Fleeing from the forest, you hope to return one day and put an end to their foul kind.))
	  ),
	  set(options, ['Leave']),
	]
	",
},

{
	title: "Vampire Call to Adventure",
	image: "portraits/vampire.png",

	quest_id: 'vampire',
	min_quest_progress: 0,
	max_quest_progress: 5,

	text: "Moving through the grassland you come across an ancient crypt. You may enter it or leave it be.",

	options: [ 'Enter', 'Leave' ],

	choose_option: "def(obj title_controller ctrl, string option) ->commands
	if(option = 'Enter', [

		  //show some dialog preparing the player to fight.
		  set(text, 'Entering the crypt you are fallen upon by dark acolytes and must fight them!'),
		  set(options, ['Battle']),
	   ],

	   option = 'Battle', [
	   	  //Go into the battle by setting the scenario the player will face.
	   	  set(scenario, {
			name: 'Izlik',
			set: 'core',
			enemy_name: 'Izlik',
			text: '',
			bot_args: {
				deck: q(['Soothsayer', 'Vampire', 'Hypothermia', 'Skeletal Parasite']*4),
			},
			portrait: 'grave-stalker.png',
			portrait_scale: 0.2,
			portrait_translate: [0,0],
			avatar: 'grave-stalker.png',
		  }),
	   ],

	   option = 'Leave', [
	      //Give the player some 'goodbye' dialog before closing out the
		  //encounter.
	   	  set(text, 'You leave the crypt be, a chill wind sweeping across the fields as you do so.'),
		  set(options, ['Finish']),
	   ],

	   option = 'Finish', [
	   	  //this will completely close down the encounter.
	   	  set(finished, true),
	   ],
	)
	",

	win_battle: "def(obj title_controller ctrl) ->commands
	[
	  ctrl.add_campaign_quest('vampire'),
	  ctrl.progress_campaign_quest('vampire', 20),
	  set(text, 'You defeat the dark acolytes, putting a dagger to the throat of their leader. Screaming in fear, she tells you of a coven of vampires near here that plan to ravage the lands. it would be a great service to the land to destroy this coven.'),
	  set(options, ['Finish']),
	]",

	lose_battle: "def(obj title_controller ctrl) ->commands
	[
	  set(text, q(The acolytes drive you from their lair, barely escaping with your life you go on your way in fear and dread.)),
	  set(options, ['Finish']),
	]
	",
},

{
	title: "Vampire Encounter 2",
	image: "portraits/vampire.png",

	quest_id: 'vampire',
	min_quest_progress: 6,
	max_quest_progress: 50,

	text: "In the rolling hills you discover one of the Crypts that the Vampire coven is said to dwell in.",

	options: [ 'Enter', 'Leave' ],

	choose_option: "def(obj title_controller ctrl, string option) ->commands
	if(option = 'Enter', [

		  //show some dialog preparing the player to fight.
		  set(text, 'Entering the crypt you fall upon vampires in the middle of a dark ritual.'),
		  set(options, ['Battle']),
	   ],

	   option = 'Battle', [
	   	  //Go into the battle by setting the scenario the player will face.
	   	  set(scenario, {
			name: 'Izlik',
			set: 'core',
			enemy_name: 'Izlik',
			text: '',
			bot_args: {
				deck: q(['Soothsayer', 'Vampire', 'Hypothermia', 'Skeletal Parasite', 'Knife in the Dark', 'Blood Altar', 'Swamp', 'Grave Stalker']*4),
			},
			portrait: 'grave-stalker.png',
			portrait_scale: 0.2,
			portrait_translate: [0,0],
			avatar: 'grave-stalker.png',

			//more than normal reward gold for this fight.
			reward_gold: 100,
		  }),
	   ],

	   option = 'Leave', [
	      //Give the player some 'goodbye' dialog before closing out the
		  //encounter.
		  //
		  //We could consider punishing the player by giving them negative progress on the quest here?
	   	  set(text, 'You leave the crypt be, a chill wind sweeping across the fields as you do so.'),
		  set(options, ['Finish']),
	   ],

	   option = 'Finish', [
	   	  //this will completely close down the encounter.
	   	  set(finished, true),
	   ],
	)
	",

	win_battle: "def(obj title_controller ctrl) ->commands
	[
	  //give the player some progress on the quest.
	  ctrl.progress_campaign_quest('vampire', 20),
	  set(text, 'You defeat the vampires, slaying them all. On the walls of the crypt you find some clues as to more crypts in the area.'),
	  set(options, ['Finish']),
	]",

	lose_battle: "def(obj title_controller ctrl) ->commands
	[
	  set(text, q(The vampires drive you from their lair, barely escaping with your life you go on your way in fear and dread.)),
	  set(options, ['Finish']),
	]
	",
},

{
	title: "Vampire Encounter 3",
	image: "portraits/vampire.png",

	quest_id: 'vampire',
	min_quest_progress: 20,
	max_quest_progress: 99,

	text: "You come across a town with a crypt where you have heard the vampire coven has a lair.",

	options: [ 'Enter', 'Leave' ],

	choose_option: "def(obj title_controller ctrl, string option) ->commands
	if(option = 'Enter', [

		  //show some dialog preparing the player to fight.
		  set(text, 'Entering the crypt you fall upon vampires in the middle of a dark ritual.'),
		  set(options, ['Battle']),
	   ],

	   option = 'Battle', [
	   	  //Go into the battle by setting the scenario the player will face.
	   	  set(scenario, {
			name: 'Izlik',
			set: 'core',
			enemy_name: 'Izlik',
			text: '',
			bot_args: {
				deck: q(['Soothsayer', 'Vampire', 'Hypothermia', 'Skeletal Parasite', 'Knife in the Dark', 'Blood Altar', 'Swamp', 'Grave Stalker', 'Duskwind Obelisk']*4 + ['Gezzix, Lord of Death']*2),
			},
			portrait: 'grave-stalker.png',
			portrait_scale: 0.2,
			portrait_translate: [0,0],
			avatar: 'grave-stalker.png',

			//more than normal reward gold for this fight.
			reward_gold: 200,
		  }),
	   ],

	   option = 'Leave', [
	      //Give the player some 'goodbye' dialog before closing out the
		  //encounter.
		  //
		  //We could consider punishing the player by giving them negative progress on the quest here?
	   	  set(text, 'You leave the crypt be, a chill wind sweeping across the fields as you do so.'),
		  set(options, ['Finish']),
	   ],

	   option = 'Finish', [
	   	  //this will completely close down the encounter.
	   	  set(finished, true),
	   ],
	)
	",

	win_battle: "def(obj title_controller ctrl) ->commands
	[
	  //give the player some progress on the quest.
	  ctrl.progress_campaign_quest('vampire', 40),
	  set(text, 'You defeat the vampires, slaying them all. On the walls of the crypt you find some clues as to more crypts in the area.'),
	  set(options, ['Finish']),
	]",

	lose_battle: "def(obj title_controller ctrl) ->commands
	[
	  set(text, q(The vampires drive you from their lair, barely escaping with your life you go on your way in fear and dread.)),
	  set(options, ['Finish']),
	]
	",
},

{
	title: "Vampire Lord",
	image: "portraits/gezzix-lord-of-death.png",

	quest_id: 'vampire',
	min_quest_progress: 100,
	max_quest_progress: 1000,

	text: "You feel a chill as you realize you have stumbled upon the home of the vampire coven, deep in the woods. You have one last chance to withdraw from the cursed grove.",

	options: [ 'Enter', 'Leave' ],

	choose_option: "def(obj title_controller ctrl, string option) ->commands
	if(option = 'Enter', [

		  //show some dialog preparing the player to fight.
		  set(text, 'Entering the grove you fall upon vampires in the middle of a dark ritual.'),
		  set(options, ['Battle']),
	   ],

	   option = 'Battle', [
	   	  //Go into the battle by setting the scenario the player will face.
	   	  set(scenario, {
			name: 'Izlik',
			set: 'core',
			enemy_name: 'Izlik',
			text: '',
			bot_args: {
				deck: q(['Soothsayer', 'Vampire', 'Hypothermia', 'Skeletal Parasite', 'Knife in the Dark', 'Blood Altar', 'Swamp', 'Grave Stalker', 'Duskwind Obelisk']*4 + ['Gezzix, Lord of Death']*2),
			},
			portrait: 'grave-stalker.png',
			portrait_scale: 0.2,
			portrait_translate: [0,0],
			avatar: 'grave-stalker.png',

			//Large reward for completing the quest
			reward_gold: 1000,

			starting_units: [
			{
				card_name: 'Blood Altar',
				loc: [2,4],
				controller: 1,
			}
			],
		  }),
	   ],

	   option = 'Leave', [
	      //Give the player some 'goodbye' dialog before closing out the
		  //encounter.
		  //
		  //We could consider punishing the player by giving them negative progress on the quest here?
	   	  set(text, 'You leave the crypt be, a chill wind sweeping across the fields as you do so.'),
		  set(options, ['Finish']),
	   ],

	   option = 'Finish', [
	   	  //this will completely close down the encounter.
	   	  set(finished, true),
	   ],
	)
	",

	win_battle: "def(obj title_controller ctrl) ->commands
	[
	  //the player has completed the quest.
	  ctrl.complete_campaign_quest('vampire'),
	  set(text, 'You have defeated the Vampire Lord and vanquished the coven. You celebrate this great victory!'),
	  set(options, ['Finish']),
	]",

	lose_battle: "def(obj title_controller ctrl) ->commands
	[
	  set(text, q(The vampires drive you from their lair, barely escaping with your life you go on your way in fear and dread.)),
	  set(options, ['Finish']),
	]
	",
},

]
